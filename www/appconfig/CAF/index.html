<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link type="text/css" rel="stylesheet" href="../css/bootstrap.css">
<link type="text/css" rel="stylesheet" href="../css/bootstrap-responsive.css">

 <script type="text/javascript" src="../js/jquery-1.10.0.js"></script>
  <script type="text/javascript" src="../js/bootstrap.js"></script>

<script type="text/javascript" src="../js/ida-deploy-core.js"></script>


</head>
<body onload="update();">

     <div class="container" style="margin-top: 5px;">
            <div class="row">
                <div class="span12">
                    <div class="hero-unit">
                        <div class="container">
                            <div class="row">
                                <div class="span10">

     
             
             <!--   
                <h5>The Steps</h5>
                <ul>
                  <li>Fill in your answers in the form below or  <a href="#use_existing_config">import an existing configuration</a>
                  <li>When complete,  click 'Generate Configuration File'. This ensures the latest edits have been captured.
                  <li>Cut and paste the results into a file named 'config' in the same directory as the installer on your server.
                  <li>run the installer command: <i>./deploy_idp.sh</i> and follow the instructions during the build process.
                  </ul>

                  <a href="#more_info">Additional Details</a> (goes to bottom of this page)<br>
               
               <h4>Let's Begin!</h4>
                <p id="begin">
                
-->


            <form>
              <input id="installer_section0_fingerprint" name="installer_section0_title" type="hidden" value="">
              <input id="installer_section0_version" name="installer_section0_version" type="hidden" value="">
              <input id="installer_section0_builddate" name="installer_section0_builddate" type="hidden" value="">
              <input id="installer_section0_title" name="installer_section0_title" type="hidden" value="">
              <input id="installer_section1_title" name="installer_section1_title" type="hidden" value="">
              <input id="installer_section2_title" name="installer_section2_title" type="hidden" value="">
              <input id="installer_section3_title" name="installer_section3_title" type="hidden" value="">
              <input id="installer_section4_title" name="installer_section4_title" type="hidden" value="">
              <input id="installer_section5_title" name="installer_section5_title" type="hidden" value="">



              <h4>
              <fieldset>
<table width="100%" border=1>
              


<!--                  <tr  bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Your Federation: Canadian Access Federation - CAF</font><b></td></tr>
    -->                <tr><td colspan="2" align="right" valign="center">

<!--
                    </td><td>

                        <select id="my_ctl_federation"  onchange="update()">
                            <option name="CAF" value="CAF" selected>Canadian Access Federation - CAF</option>
                           <option name="SWAMID" value="SWAMID">Swedish Academic Identity - SWAMID</option>
                            </select>
    -->
                            <input type="hidden" id="my_ctl_federation" value="CAF" onchange="update()">



<a name="top_of_page"></a>

 <table width=100% border=1>
    <tr><td>
      <font size="+2" ><b>Identity Appliance Interactive Configuration Builder</b></font>
      <br>
      An interactive tool to help build your eduroam and Shibboleth configuration

    </td>
        <td align=right colspan=2>
          <img align="center" width="250" src="./img/logo.png" alt="Federation Operator logo" />
  </td></tr>

  <tr><td> 
<!-- comments area -->

<!-- end comments area -->

    </td>


    <td align="right"> <a href="#use_existing_config">import an existing configuration</a>
  </td>
  <td>

                            <button class="btn" onclick="window.open ('help.html','help window',popupWinSettings);" >
                                                Help
                                            </button>
    </td></tr>
  </table>

                    </td></tr>

<!-- end tool header -->


   <tr id="my_installer_section0_buildComponentListRow" class="status" bgcolor="#CCCCCC">
    <td colspan="2">
      <b><font size="+1">Please select components to configure for your installation</font><b>
    </td></tr>


   <tr><td colspan="2" align="left">

<table border=1 cellpadding=10>
  <tr><td>

    <table border=0 cellpadding=4>
      <tr><td>
        eduroam service using FreeRADIUS:
    </td>
    <td>
        <input id="ida_component_eduroam" 
        onclick="refreshComponentsList();c=cFilled;if (this.checked==true){c=cNeeded}else {c=cNeutral} setDependantFieldColours(c,requiredFieldKeysEduroam);" 
        type="checkbox" name="ida_component_eduroam" value="on"/>
    </td></tr>
     <tr><td>
    Federated SSO Identity Provider service using Shibboleth: 
       </td>
    <td>

    <input id="ida_component_shibboleth" 
    onclick="refreshComponentsList();c=cFilled;if (this.checked==true){c=cNeeded}else {c=cNeutral} setDependantFieldColours(c,requiredFieldKeysShibboleth);" 
         type="checkbox" name="ida_component_shibboleth" value="on" />
    </td></tr>
  </table>
              <input type="hidden" id="installer_section0_buildComponentList" type="text" placeholder="" value="" >


</td><td>

<font size="-1">
<b>Instructions</b>
    <br> - Choose which service(s) you would like to configure or import an existing configuration.
    <br> - Incomplete required fields will be highlighted yellow, green indicates field is ready
    <br> - Once all the fields for the service are completed, cut and paste results into config file in same directory as the deploy tool
    <br> - Initiate deployment by executing <i>./deploy_idp.sh</i> on the target server to initiate the install
</font>

</td></tr>
</table>

  </td></tr>


<!-- general header section -->
   <tr id="my_generalHeaderSectionRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+2">General Information</font><b></td></tr>
    

   <tr><td colspan="2" align="right">
    
  </td></tr>
<!-- end header -->


   <tr id="my_installer_section0buildDescriptionRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Document This Configuration</font><b></td></tr>
    

   <tr><td colspan="2" align="right">
     Brief description for this configuration:
          <input style="width: 300px;" id="installer_section0_buildDescription" type="text" placeholder="My Development configuration" 
                onchange="updateCtx(this)" > <br>

<!--
                onchange="update();this.style.backgroundColor=cFilled;" > <br>
                c=cFilled;if (this.checked==true){c=cNeeded} 
   --> 
  </td></tr>


   <tr id="my_idpurlRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Name of Server Running This Configuration</font><b></td></tr>
    
   <tr><td colspan="2" align="right">

    Public URL of the Server:<input id="idpurl" type="text" placeholder="https://idpdev.mydomain.ca" onchange="update()"><BR>

  </td></tr>

   
   <tr id="my_eduroamDomainRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Set the eduroam Domain and/or Federated SSO scope</font><b></td></tr>
    
   <tr><td colspan="2" align="right">
    What is your organization's domain?:
          <input id="my_eduroamDomain" type="text" placeholder="mydomain.ca" 
                onchange="update(); document.getElementById('my_eduroamDomainRow').style.backgroundColor='#6AA121';" ><br>

  </td></tr>

<!-- general header section -->
   <tr id="my_generalHeaderSectionRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+2">eduroam Specific Configuration Information</font><b></td></tr>
    

   <tr><td colspan="2" align="right">
    
  </td></tr>
<!-- end header -->

                                          
<tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Your Active Directory settings</font><b></td></tr>
                                            <tr><td colspan="2">
                                            For eduroam (RADIUS) MSCHAPv2  authentication to work, this machine must join your AD domain.
                                          </td><td></tr>
                                           <tr>
<td colspan="2" align="right">
<table><tr><td colspan="1" align="left"><font size="-1">WinBIND krb5 settings</font></td></tr></table>
Active Directory Default AD DOMAIN:<input id="krb5_libdef_default_realm" type="text" placeholder="DOMAIN.LOCAL" onchange="update();this.style.backgroundColor=cFilled;"><br>

<!-- AD Default AD DOMAIN lowercased: --> <input id="krb5_realms_def_dom" type="hidden" placeholder="e.g. domain.local" onchange="update()">

Active Directory Internet Domain:<input id="krb5_domain_realm" type="domain.ca" placeholder="e.g. domain.ca" onchange="update()"><br>
<hr>
<table><tr><td colspan="1" align="left"><font size="-1">SAMBA settings</font></td></tr></table>
Active Directory Domain Name - pre-windows2000/NETBIOS Name:<input id="smb_workgroup" type="text" placeholder="e.g. DOMAIN" onchange="update()"><br>
Legacy NETBIOS host name in Active Directory:<input id="smb_netbios_name" type="text" placeholder="e.g. APP1" onchange="update()"><br>
IP Address of your Primary AD DC:<input id="smb_passwd_svr" type="text" placeholder="e.g. 1.2.3.4" onchange="update()"><br>
SAMBA Active Directory DOMAIN:<input id="smb_realm" type="text" placeholder="e.g. DOMAIN.LOCAL" onchange="update()"><br>

</td></tr>

<tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Your RADIUS configuration</font><b></td></tr>
                                            <tr><td colspan="2">
                                            FreeRADIUS will behave as both a proxy and server for local clients.<br>
                                            A Client can be anything that talks the RADIUS protocol, including other RADIUS servers, access points, laptops, and/or smart phones.<br>

                                           
                                          </td><td></tr>
                                           <tr>
<td colspan="2" align="right">

domain used for eduroam:<input id="freeRADIUS_realm" type="text" placeholder="" onchange="update()"><br>
Active Directory realm used to authenticate users:<input id="freeRADIUS_pxycfg_realm" type="text" placeholder="" onchange="update()"><br>
Passphrase to your upstream eduroam servers:<input id="freeRADIUS_cdn_prod_passphrase" type="text" placeholder="" 
onchange="if(this.value.indexOf('#')>-1){alert(PoundSignError);}else{update();}"><br>
<hr>
Access Point #1 IP Address:<input id="freeRADIUS_clcfg_ap1_ip" type="text" placeholder="" onchange="update()"><br>
Access Point #1 Passphrase(min 8 char):<input id="freeRADIUS_clcfg_ap1_secret" type="text" placeholder="" 
onchange="if(this.value.indexOf('#')>-1){alert(PoundSignError);}else{update();}"><br>
<hr>
Access Point #2 IP Address:<input id="freeRADIUS_clcfg_ap2_ip" type="text" placeholder="" onchange="update()"><br>
Access Point #1 Passphrase(min 8 char):<input id="freeRADIUS_clcfg_ap2_secret" type="text" placeholder="" 
onchange="if(this.value.indexOf('#')>-1){alert(PoundSignError);}else{update();}"><br>

<!-- <tr><td>installer_section3_title:</td><td><input id="installer_section3_title" type="text" placeholder="" onchange="update()"></td></tr>
-->

</td></tr>



   <tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Information for the TLS Generation</font><b></td></tr>
                                            <tr><td colspan="2">
                                            eduroam needs TLS for encrypting tunnels between your server and the person authenticating. Please provide details to create a self signed Certificate Authority(CA) and Server certificate.
<br> 
                                          </td><td></tr>
                                           <tr>
<td colspan="2" align="right">
Certificate Authority Prov/State:<input id="freeRADIUS_ca_state" type="text" placeholder="" onchange="update()"><BR>
Certificate Authority City:<input id="freeRADIUS_ca_local" type="text" placeholder="" onchange="update()"><BR>
Certificate Authority Org Name:<input id="freeRADIUS_ca_org_name" type="text" placeholder="Institution X" onchange="update()"><BR>
Certificate Authority Contact email:<input id="freeRADIUS_ca_email" type="text" placeholder="" onchange="update()"><BR>
Certificate Authority Common Name:<input id="freeRADIUS_ca_commonName" type="text" placeholder="Inst. X SelfSigned CA Authority" 
onchange="if(this.value.indexOf('#')>-1){alert(PoundSignError);}else{update();}"><br>
<!-- installer_section4_title:<input id="installer_section4_title" type="text" placeholder="" onchange="update()"><BR> -->
 Copy info to fields below? 
    <input id="dupeData1" onclick="return duplicateContactInfo();" type="checkbox" name="dupeData1" value="yes" />

</td></tr>

   <tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Information for the Server Certificate TLS Generation</font><b></td></tr>
<tr><td colspan="2" align="right">


Server Certificate Prov/State:<input id="freeRADIUS_svr_state" type="text" placeholder="" onchange="update()"><BR>
Server Certificate City:<input id="freeRADIUS_svr_local" type="text" placeholder="" onchange="update()"><BR>
Server Certificate Org Name:<input id="freeRADIUS_svr_org_name" type="text" placeholder="" onchange="update()"><BR>
Server Certificate Contact email:<input id="freeRADIUS_svr_email" type="text" placeholder="" onchange="update()"><BR>
Server Certificate Common Name:<input id="freeRADIUS_svr_commonName" type="text" placeholder="idp.domain.ca" onchange="update()"><BR>

</td></tr>

<!-- general header section -->
   <tr id="my_generalHeaderSectionRow" class="status" bgcolor="#CCCCCC"><td colspan="2"><b><font size="+2">Federated Single Sign On Configuration  Information</font><b></td></tr>
    

   <tr><td colspan="2" align="right">
    
  </td></tr>
<!-- end header -->

<tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">Base Configuration for FedSSO</font><b></td></tr>
                                            <tr><td colspan="2">
Federated SSO needs credentials to connect to your Directory for 'find and bind' operations as well as to access data about a user.<br> 
                                          </td><td></tr>
                                           <tr>
<td colspan="2" align="right">
Servlet Container:<input id="appserv" type="text" placeholder="tomcat" value="tomcat" readonly onchange="update()"><BR>
Authentication type (ldap):<input id="type" type="text" placeholder="ldap" value="ldap" readonly onchange="update()"><BR>
ntpserver:
<!-- <input id="fedSSO_ntpserver" type="text" placeholder="" onchange="update()"> --> 
<select id="ntpserver"  onchange="update()">
      <option name="Vancouver1" value="nt1-cdma.vncv1.bc.net" selected>Vancouver - nt1-cdma.vncv1.bc.net (Stratum 1 - CDMA)</option>
     <option name="Kelowna" value="t1-cdma.keltx1.bc.net">Kelowna - t1-cdma.keltx1.bc.net (Stratum 1 - CDMA)</option>
     <option name="Saskatoon1" value="tick.usask.ca">Saskatoon - tick.usask.ca (Stratum 1 - GPS)</option>
     <option name="Saskatoon2" value="tock.usask.ca">Saskatoon - tock.usask.ca (Stratum 1 - GPS)</option>
     <option name="Winnipeg1" value="tick.umanitoba.ca">Winnipeg - tick.umanitoba.ca (Stratum 1 - GPS)</option>
     <option name="Winnipeg2" value="tock.umanitoba.ca">Winnipeg - tock.umanitoba.ca (Stratum 1 - GPS)</option>
     <option name="Halifax" value="tick.acorn-ns.ca">Halifax tick.acorn-ns.ca (Stratum 1 - GPS)</option>
     
      </select>

<BR>
LDAP Server Host(separate servers with a space):<input  style="width: 250px;" id="ldapserver" type="text" placeholder="" onchange="update()"><BR>
LDAP Bind DN:<input  style="width: 250px;" id="ldapbinddn" type="text" placeholder="" onchange="update()"><BR>
LDAP Password:<input  style="width: 250px;" id="ldappass" type="text" placeholder="" onchange="update()"><BR>

LDAP Base DN:<input  style="width: 250px;" id="ldapbasedn" type="text" placeholder="" onchange="update()"><BR>

LDAP Subtree search?: <select id="subsearch"  onchange="update()">
                                                <option name="subsearchTrue" value="true" selected>Yes</option>
                                               <option name="subsearchFalse" value="false">No</option>
                                             </select>
                                             <br>


</td></tr>

<tr bgcolor="#CCCCCC"><td colspan="2"><b><font size="+1">FedSSO Features</font><b></td></tr>
                                            <tr><td colspan="1">
These are some additional configurations that enhance the FedSSO operation<br> 
                                          </td><td></tr>
                                           <tr>
<td colspan="2" align="right">
Install support for ePTID <select id="eptid"  onchange="update()">
                                                <option name="eptidY" value="y" selected>Yes(recommended)</option>
                                               <option name="eptidN" value="n">No</option>
                                             </select>
                                             <br>
Send anonymous usage stats to CAF <select id="fticks"  onchange="update()">
                                                <option name="ftickY" value="y" selected>Yes(recommended)</option>
                                               <option name="ftickN" value="n">No</option>
                                             </select>
                                             <br>

<!-- google apps support -- not supported by CAF, but other federations config may permit it, CAF uses hidden value -->

<input type=hidden id="google" value="n">
<!--
Enable Support to sign into Google Apps  <select id="google"  onchange="update()">
                                                <option name="googleY" value="y" selected>Yes</option>
                                               <option name="googleN" value="n">No</option>
                                             </select>
                                             <br>
-->
<!-- NorduNet NINC Support - not CAF, only SWAMID functionality, CAF uses hidden value-->

<input type=hidden id="ninc" value="n">
<!--
Enable Support norEduPersonNIN  <select id="ninc"  onchange="update()">
                                                <option name="nincY" value="y" selected>Yes</option>
                                               <option name="nincN" value="n">No</option>
                                             </select>
                                             <br>
-->

</td></tr>
<!-- <tr>
<td colspan="2" align="right">
Keystore password for FedSSO encryption keys <input  style="width: 250px;" id="pass" type="text" placeholder="" onchange="update()">
                                             <br>
Keystore password for HTTPS Server encryption keys <input  style="width: 250px;" id="httpspass" type="text" placeholder="" onchange="update()">
                                             <br>
</td></tr>
-->
<!-- <tr><td>installer_section2_title:</td><td><input id="installer_section2_title" type="text" placeholder="" onchange="update()"></td></tr>
-->

</table>
                                        </fieldset>
                                        <br>


                                        <button type="submit" class="btn" onclick="return formSubmit();" >
                                                Generate Configuration File
                                            </button>
                                    </form>
                                </div>
                                <div class="span6">
       </div>
                            </div>
                        </div>
                       



       
<form>
          <label>        <h4>Autogenerated Configuration File</h4>          </label>

         <textarea id="outputArea" class="span7"  rows="49" cols="40"></textarea>

       </form>


<form>
          <label>             <a name="use_existing_config"></a> <h4>Import Configuration File</h4>          </label>

<table width="40%">
  <tr><td align="right">

<button type="submit" class="btn" onclick="return importPreviousSettings(); " >Import My Existing Config From Below </button>

  </td><td align="right">
 <a href="#top_of_page">back to top</a>
</td></tr></table>

         <textarea id="importPreviousConfigArea" class="span7"  rows="10" cols="40"></textarea>

<hr color="red" size="10"><hr>
 

                                     </form>
                                    <!-- <p id="test">Content</p> -->



<!-- 
<a name="more_info"></a>
<h2>Additional Notes</h2>

<h3>Intended Audience</h3>
                                        It is recommended that the person collecting the information and using this tool has working knowledge of:<br>
                                        <ul><li>Operating wireless networks and related infrastructure
                                        <li>An understanding of Microsoft Active Directory and is familiar with their local  installation of it
                                        <li>how to prepare a basic CentOS 'minimal install' image to use the installer on. 
                                        </ul>

                                       <h3>How Much Time Should I Plan For?</h3>
                                        <p id="planning_time">The actual installation and execution of the installer is a few minutes. That said, the preparation time of collecting and planning around some of the answers for the configuration may take longer. Note that the configuration can only be generated at this time and not reverse engineered from an existing configuration file. 
                                       <h3>What Do I get When I'm done?</h3>
                                        <p id="when_done">The installer will install FreeRADIUS and SAMBA to connect to Active Directory to do authentication. It will use self signed certificates and is sufficient to use as a testbed and be easily operated on it's own. <br>
                                            Deploying a production instance is simply re-using the same configuration file as needed and choosing your commercial server certificate.  The install process does generate a CSR(Certificate Signing Request) that could be used.
                                       <h3>What about Passwords and Shared Secrets etc?</h3>
                                        <p id="what_about">This web page does not need to be run on a server and is entirely self contained. When you use it, you CAN use it from a webserver but also within a local browser. It generates a local copy of the configuration file which you then place on the appropriate server and location</p>

  <h5>A Word About Security</h5>
                  We recognize that collecting information to key systems with credentials and passwords should be treated carefully.  With this in mind, this HTML page uses local javascript and JQuery libraries to produce the configuration file used to do the installation. It intentionally does not store any passwords and/or configuration details and allows you to cut and paste the resulting configuration file where you need it.<br>
                  With this in mind, we've also created a feature where you can take an existing configuration file and import it. <br> <a href="#use_existing_config">Click here to import your existing configuration</a>

                
                <h5>Intended Installer Uses</h5>

                This installer is designed to provide a base configuration with self signed certificates for a streamlined installation. It is possible to have a test installation up and going in a few minutes once you have your configuration details.  To deploy a production configuration, the same configuration you used in test can be used to create the production installation with a few adjustments for production operations.

                 <h5>Adjustments to a Base Install to be Production Ready</h5>

                 Updates to the base install for production use are:
                <ul>
                  <li>Replacing the self signed certificate used on the web and RADIUS server with your commercial certificate.<sup>*</sup> 
                  <li>Connect to the appropriate authoritative identity data source on the back end.
                  <li>Any desired updates to the web sign on page
                 </ul>   
                <br>
                 <sup>* a Certificate Signing Request(<a href="http://en.wikipedia.org/wiki/Certificate_signing_request" target="new">CSR</a>(new window) is generated in the base install 
                  </sup>

                <br>
-->

</div>
 </div>
 </div>
        </div>
    </body>
</html>
